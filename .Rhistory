source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
roc
aucrf
aucrf=auc(roc)
pred_score <- predict(rf, testing, type ='prob')[,2]
pred <- prediction(pred_score, testing$DSBType)
roc <- performance(pred, "tpr", "fpr")
aucrf=auc(roc)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
as.data.frame(table(training$DSBType))
over = ovun.sample(DSBType~., data=training, method="over", N=3160)
table(over$DSBType)
summary(over)
table(over)
as.data.frame(table(over$DSBType))
over
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
over
summary(training)
summary(over)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
levels(over)
levels(over$DSBType)
levels(training)
levels(as.data.frame(training))
levels(dataDSB)
str(training)
str(over)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
View(new_training)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
varImpPlot()
varImpPlot(rf)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
pred
read.table(pred)
as.data.frame(table(pred))
View(auc)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
legend(.85,.23,auc, title="AUC", cex =1.2, colorize = T)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
legend(.85,.23,auc, title="AUC", cex =1.2)
abline(a=0, b=1)
pred_score
summary(pred_score)
summary(pred_score)
pred_score <- predict(rf, testing$DSBType, type ='prob')[,2]
pred_score <- predict(rf, testing, type ='prob')[,2]
summary(pred_score)
summary(pred)
summary(roc)]
summary(roc)
pred_score
summary(pred_score)
pred_score <- predict(rf, testing, type ='class')[,2]
pred_score <- predict(rf, testing, type ='class')
summary(pred_score)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
pred_score <- predict(rf, testing, type ="response")[,2]
pred_score <- predict(rf, testing, type ="response")
summary(pred_score)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
pred_score <- predict(rf, testing$DSBType)[,2]
pred_score <- predict(rf, testing$DSBType)
pred_score <- predict(rf, testing, type="prob")[,2]
summary(pred_score)
pred_score <- predict(rf, training, type="prob")[,2]
summary(pred_score)
pred_score <- predict(rf, testing$DSBType, type="Response")[,2]
pred_score <- predict(rf, testing$DSBType, type="Response")
pred_score <- predict(rf, testing, type="Response")[,2]
pred_score <- predict(rf, testing, type="Response")
summary(pred_score)
roc(pred_score, "tpr", "fpr")
pred <- prediction(pred_score, testing)
pred <- prediction(pred_score, testing$DSBType)
pred_score
pred <- predict(rf, testing, type="Response")[,2]
pred <- predict(rf, testing, type="Response")
summary(pred)
cm = table(testing$DSBType, y_pred)
cm = table(testing$DSBType, pred)
print(cm)
pred <- predict(rf, training, type="Response")
cm=table(training$DSBType, pred)
print(cm)
pred <- predict(rf, testing, type="Response")
cm=table(testing$DSBType, pred)
print(cm)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
balanced.training
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
dput(training)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
varImpPlot(rf)
importance(rf)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
library(cvms)
plot_confusion_matrix(cm,
target_col = "target",
prediction_col = "prediction",
counts_col = "n")
plot_confusion_matrix()
library(cvms)
library(cvms)
plot_confusion_matrix(cm,
target_col = "target",
prediction_col = "prediction",
counts_col = "n")
plot_confusion_matrix()
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
print(cm)
plot(cm)''
plot(cm)
plot(cm, main="Very Simple Confusion Matrix")
varImp()
importance(rf)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
1:nrow(dataDSB)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
computed_signals_file = "C:/R_scripts_feng/tp/Data/breaks_DMSO_NT/NM_DN_features_includingdist.txt"
as.data.frame(read_table(computed_signals_file))
as.data.fram(read.table(computed_signals_file))
as.data.frame(read.table(computed_signals_file))
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
library(rfPermute)
plotConfMat(rf, title="ConfusionMatrix", plot=true)
library(rfPermute)
rfPermute::confusionMatrix(rf, title="ConfusionMatrix",plot=true)
rfPermute::confusionMatrix(rf)
rfPermute::confusionMatrix(rf, plot="TRUE")
rfPermute::confusionMatrix(rf, plot=TRUE)
rfPermute::plotConfMat(rf, title="ConfusionMatrix",plot=TRUE
)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
pred
pred[1]
read.table(pred)
as.data.frame(pred)
prediction(pred, testing$DSBType)
predict(rf, testing, type="Prob")[,2]
prediction(pred, testing$DSBType)
predict(rf, testing, type='Response')
pred_response <- predict(rf, testing, type="Response")
View(pred)
View(pred_score)
pr <- pr.curve(scores.class0 = pred(testing$DSBType=="1"), scores.class1 = pred(testing$DSBType=="0"), curve=T)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
pred
pred(testing$DSBType=="1")
pred[testing$DSBType=="1"]
pred["1"]
pred
pred_response
pred_response[testing$DSBType=="1"]
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
pr <- pr.curve(scores.class0 = pred_response[testing$DSBType=="1"], scores.class1 = pred_response[testing$DSBType=="0"], curve=T)
pred_response[testing$DSBType=="0"]
pred_response[testing$DSBType=="1"]
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
pr <- pr.curve(scores.class0 = pred_response[,testing$DSBType=="1"], scores.class1 = pred_response[,testing$DSBType=="0"], curve=T)
pr <- pr.curve(scores.class0 = pred_response[testing$DSBType=="1",], scores.class1 = pred_response[testing$DSBType=="0",], curve=T)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
shape(testing$DSBType)
summary(testing$DSBType)
summary(pred)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
View(dataDSB)
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
plot(roc, main="ROC Curve")
print(auc@y.values)
plot(roc, main="ROC Curve")
auc <- performance(pred, "auc")
auc <- unlist(slot(auc, "y.values"))
auc <- round(auc, 4)
legend(.85,.23,auc, title="AUC", cex =1.2)
abline(a=0, b=1)
print(auc@y.values)
plot(roc, main="ROC Curve")
auc <- performance(pred, "auc")
auc <- unlist(slot(auc, "y.values"))
auc <- round(auc, 4)
legend(.85,.23,auc, title="AUC", cex =1.2)
abline(a=0, b=1)
print(auc@y.values)
plot(roc, main="ROC Curve", size=large)
auc <- performance(pred, "auc")
auc <- unlist(slot(auc, "y.values"))
auc <- round(auc, 4)
legend(.85,.23,auc, title="AUC", cex =1.2)
abline(a=0, b=1)
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
plot(1:10)
plot(1:100)
plot(1:22000)
plot(1:222)
plotsize
importance(rf, log="2")
varImpPlot(rf, scale=log2())
varImpPlot(rf)
plot(roc)
auc = performance(pred, measure = "auc")
print(auc@y.values)
plot(roc, main="ROC Curve")
auc <- performance(pred, "auc")
auc <- unlist(slot(auc, "y.values"))
auc <- round(auc, 4)
legend(.85,.23,auc, title="AUC", cex =1.2)
abline(a=0, b=1)
auc = performance(pred, measure = "auc")
print(auc@y.values)
plot(roc, main="ROC Curve")
auc <- performance(pred, "auc")
auc <- unlist(slot(auc, "y.values"))
auc <- round(auc, 4)
legend(.85,.23,auc, title="AUC", cex =.6)
abline(a=0, b=1)
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
importance(rf, color =T)
varImpPlot(rf, main="Variable Importance Plot", color=T)
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
plotConfMat(rf, title = NULL, plot = TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_DMSO.R")
#NT
#First creating nonNT distance file
#Now load in new data by file
H3K36me3_distance_file = "C:/R_scripts_feng/tp/Data/Random_Sample_NT/distance_features/H3K36me3_NMnt_shuffled_closest.bed"
H3K27me3_distance_file =  "C:/R_scripts_feng/tp/Data/Random_Sample_NT/distance_features/H3K27me3_NMnt_shuffled_closest.bed"
H3K4me3_distance_file = "C:/R_scripts_feng/tp/Data/Random_Sample_NT/distance_features/H3K4me3_NMnt_shuffled_closest.bed"
DNaseIHSS1_distance_file = "C:/R_scripts_feng/tp/Data/Random_Sample_NT/distance_features/DNaseIHSS1_NMnt_shuffled_closest.bed"
DNaseIHSS2_distance_file = "C:/R_scripts_feng/tp/Data/Random_Sample_NT/distance_features/DNaseIHSS2_NMnt_shuffled_closest.bed"
CTCF_distance_file = "C:/R_scripts_feng/tp/Data/true_DSB_NT/distance_features/CTCF_NMnt_closest.bed"
Origin_distance_file = "C:/R_scripts_feng/tp/Data/Random_Sample_NT/distance_features/Origin_NMnt_shuffled_closest.bed"
#Input last three columns into main dataframe (sum, mean0, mean), drop mean0
#H3K36me3, initialize df1 (main dataframe)
df1 <- read.csv(H3K36me3_distance_file, sep="\t", header=0)
df1 <- df1[,-c(4:15)] # get rid of every column except bed info + actual value
colnames(df1) <- c("Chr", "Start", "End", "Distance_to_H3K36me3")
#H3K27me3
df2 <- read.csv(H3K27me3_distance_file, sep="\t", header=0)
df2 <- df2[,-c(1:15)] # get rid of every column except actual value
df1$Distance_to_H3K27me3 <- c(df2)
#H3K4me3
df2 <- read.csv(H3K4me3_distance_file, sep="\t", header=0)
df2 <- df2[,-c(1:15)] # get rid of every column except actual value
df1$Distance_to_H3K4me3 <- c(df2)
#DNase1HSS1
df2 <- read.csv(DNaseIHSS1_distance_file, sep="\t", header=0)
df2 <- df2[,-c(1:15)] # get rid of every column except actual value
df1$Distance_to_DNaseIHSS1 <- c(df2)
#DNase1HSS2
df2 <- read.csv(DNaseIHSS2_distance_file, sep="\t", header=0)
df2 <- df2[,-c(1:15)] # get rid of every column except actual value
df1$Distance_to_DNaseIHSS2 <- c(df2)
#CTCF
df2 <- read.csv(CTCF_distance_file, sep="\t", header=0)
View(df2)
#NT
#First creating nonNT distance file
#Now load in new data by file
H3K36me3_distance_file = "C:/R_scripts_feng/tp/Data/true_DSB_NT/distance_features/H3K36me3_NMnt_closest.bed"
H3K27me3_distance_file =  "C:/R_scripts_feng/tp/Data/true_DSB_NT/distance_features/H3K27me3_NMnt_closest.bed"
H3K4me3_distance_file = "C:/R_scripts_feng/tp/Data/true_DSB_NT/distance_features/H3K4me3_NMnt_closest.bed"
DNaseIHSS1_distance_file = "C:/R_scripts_feng/tp/Data/true_DSB_NT/distance_features/DNaseIHSS1_NMnt_closest.bed"
DNaseIHSS2_distance_file = "C:/R_scripts_feng/tp/Data/true_DSB_NT/distance_features/DNaseIHSS2_NMnt_closest.bed"
CTCF_distance_file = "C:/R_scripts_feng/tp/Data/true_DSB_NT/distance_features/CTCF_NMnt_closest.bed"
Origin_distance_file = "C:/R_scripts_feng/tp/Data/true_DSB_NT/distance_features/Origin_NMnt_closest.bed"
#Input last three columns into main dataframe (sum, mean0, mean), drop mean0
#H3K36me3, initialize df1 (main dataframe)
df1 <- read.csv(H3K36me3_distance_file, sep="\t", header=0)
df1 <- df1[,-c(4:15)] # get rid of every column except bed info + actual value
colnames(df1) <- c("Chr", "Start", "End", "Distance_to_H3K36me3")
#H3K27me3
df2 <- read.csv(H3K27me3_distance_file, sep="\t", header=0)
df2 <- df2[,-c(1:15)] # get rid of every column except actual value
df1$Distance_to_H3K27me3 <- c(df2)
#H3K4me3
df2 <- read.csv(H3K4me3_distance_file, sep="\t", header=0)
df2 <- df2[,-c(1:15)] # get rid of every column except actual value
df1$Distance_to_H3K4me3 <- c(df2)
#DNase1HSS1
df2 <- read.csv(DNaseIHSS1_distance_file, sep="\t", header=0)
df2 <- df2[,-c(1:15)] # get rid of every column except actual value
df1$Distance_to_DNaseIHSS1 <- c(df2)
#DNase1HSS2
df2 <- read.csv(DNaseIHSS2_distance_file, sep="\t", header=0)
df2 <- df2[,-c(1:15)] # get rid of every column except actual value
df1$Distance_to_DNaseIHSS2 <- c(df2)
#CTCF
df2 <- read.csv(CTCF_distance_file, sep="\t", header=0)
df2 <- df2[,-c(1:15)] # get rid of every column except actual value
df1$Distance_to_CTCF <- c(df2)
#Origin
df2 <- read.csv(Origin_distance_file, sep="\t", header=0)
df2 <- df2[,-c(1:8)] # get rid of every column except actual value
df1$Distance_to_Origin <- c(df2)
colnames(df1) <- c("Chr", "Start", "End","Distance_to_Origin","Distance_to_CTCF","Distance_to_DNaseIHSS1","Distance_to_DNaseIHSS2","Distance_to_H3K4me3","Distance_to_H3K27me3","Distance_to_H3K36me3")
#Ok, now need to create NT_distance_features
View(df1)
df2 <- read.csv(Origin_distance_file, sep="\t", header=0)
View(df2)
df2 <- read.csv("C:/R_scripts_feng/tp/Data/true_DSB_NT/signal_features/CTCF_NMnt_closest.bed", sep="\t", header=0)
df2 <- read.csv("C:/R_scripts_feng/tp/Data/true_DSB_NT/signal_features/CTCFbw.over.NM.NT.txt", sep="\t", header=0)
View(df2)
source("C:/R_scripts_feng/tp/DSB_prediction_NonAPH_APH.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonAPH_APH.R", echo=TRUE)
View(dataDSB)
source("C:/R_scripts_feng/tp/DSB_prediction_NonAPH_APH.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonDMSO_DMSO.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
table <- importance(rf)
plot(table)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
table
paste0("S")
paste0(sep="\t")
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
grid.table(table, newpage =TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonDMSO_DMSO.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonAPH_APH.R", echo=TRUE)
plot(pr, avg= "threshold",
ylim=c(0.2,1),
lwd= 3,
main= "NT PR Curve")
plot(pr,
lty=3,
col="grey78",
add=TRUE)
legend(.85,.23,auc, title="AUC", cex =1.2)
testing$DSBType==1
testing$DSBType
testing$DSBType=1
summary(testing$DSBType=1)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
pr
pr.curve(scores.class0=pred, scores.class1=testing$DSBType)
pr.curve(scores.class0=testing$DSBType, scores.class1=pred)
auc <- AUPRC(pr, comp.precision=TRUE) # for AUPRC
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
library(graph)
install.packages(graph)
library(PerfMeas)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("graph", version = "3.8")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")BiocManager::install("graph", version = "3.8")
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("graph", version = "3.14")
str(testingDSB$Type==1)
str(testing$DSBType)
count(testing$DSbType)
sum(is.1(testing))
lenght(which(testing$DSBType==1))
length(which(testing$DSBType==1))
length(which(testing$DSBType==0))
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
AUPRC
auc
plot(aucpr)
plot(AUPRC)
plot(AUPRC,AUPRC)
performance(pred, "aucpr")
performance(pred, "auc")
auc <- performacne(pred, "auc")
auc <- performance(pred, 'auc')
auc
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
AUPRC = performance(pred, measure = "aucpr")
AUPRC
auc <- performance(pred, "auc")
auc <- unlist(slot(auc, "y.values"))
auc
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonAPH_APH.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonDMSO_DMSO.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonDMSO_DMSO.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonAPH_APH.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonDMSO_DMSO.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonNT_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonAPH_APH.R", echo=TRUE)
#Create training and test sets
data_set_size = floor(nrow(dataDSB)*0.70) # 50% training, 50% test
auc <- performance(pred, "auc")
source("C:/R_scripts_feng/tp/scamming_multi_ROC_for_classification.R", echo=TRUE)
source("C:/R_scripts_feng/tp/scamming_multi_ROC_for_classification.R", echo=TRUE)
source("C:/R_scripts_feng/tp/scamming_multi_ROC_for_classification.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_APH_NT.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R", echo=TRUE)
View(training)
View(testing)
source("C:/R_scripts_feng/tp/DSB_prediction_DMSO_APH.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonAPH_APH.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonAPH_APH.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonDMSO_DMSO.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_NonDMSO_DMSO.R", echo=TRUE)
source("C:/R_scripts_feng/tp/DSB_prediction_APH_NT.R", echo=TRUE)
View(dataDSB)
head(training)
head(testing)
print.data.frame(training)
source("C:/R_scripts_feng/tp/DSB_prediction_APH_NT.R")
APH_NT_pred()
source("C:/R_scripts_feng/tp/DSB_prediction_APH_NT.R")
APH_NT_pred()
source("C:/R_scripts_feng/tp/DSB_prediction_APH_NT.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_NT.R")
APH_NT_pred()
source("C:/R_scripts_feng/tp/DSB_prediction_APH_NT.R")
APH_NT_pred()
source("C:/R_scripts_feng/tp/DSB_prediction_APH_NT.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_NT.R")
APH_NT_pred()
source("C:/R_scripts_feng/tp/DSB_prediction_APH_NT.R")
source("C:/R_scripts_feng/tp/DSB_prediction_APH_NT.R")
APH_NT_pred()
source("C:/R_scripts_feng/tp/DSB_prediction_APH_NT.R")
APH_NT_pred()
source("C:/R_scripts_feng/tp/master.R")
source("C:/R_scripts_feng/tp/master.R")
source("C:/R_scripts_feng/tp/master.R")
source("C:/R_scripts_feng/tp/master.R")
